{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useUser}from'../context/UserContext';import{apiService}from'../services/apiService';import ContentFeed from'../components/content/ContentFeed';import LocationSelector from'../components/profile/LocationSelector';import{MapPin,Calendar,Users,TrendingUp}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{var _content$agent_respon,_content$agent_respon2,_content$agent_respon3;const{userPreferences,updateLocation}=useUser();const[content,setContent]=useState(null);const[loading,setLoading]=useState(true);const[showLocationSelector,setShowLocationSelector]=useState(false);const hasLocation=userPreferences===null||userPreferences===void 0?void 0:userPreferences.primaryLocation;useEffect(()=>{if(hasLocation){loadPersonalizedContent();}else{setLoading(false);}},[hasLocation,userPreferences]);const loadPersonalizedContent=async()=>{try{setLoading(true);const location=\"\".concat(userPreferences.primaryLocation.city,\", \").concat(userPreferences.primaryLocation.province);const response=await apiService.getPersonalizedContent(location,{interests:userPreferences.interests,past_events:[]// TODO: Track user's past events\n});setContent(response);}catch(error){console.error('Failed to load content:',error);}finally{setLoading(false);}};const handleLocationSelect=async location=>{try{await updateLocation(location,true);setShowLocationSelector(false);}catch(error){console.error('Failed to update location:',error);}};// Location setup screen\nif(!hasLocation){return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-96 flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center space-y-6 max-w-md mx-auto px-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto\",children:/*#__PURE__*/_jsx(MapPin,{className:\"w-8 h-8 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Welcome to Community Hub!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"To get started, let us know where you're located so we can find relevant local events and news for you.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLocationSelector(true),className:\"btn-primary w-full\",children:\"Set Your Location\"})]}),showLocationSelector&&/*#__PURE__*/_jsx(LocationSelector,{onLocationSelect:handleLocationSelect,onClose:()=>setShowLocationSelector(false)})]});}// Loading state\nif(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-96 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Discovering community events...\"})]})});}// Main content view\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-4 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(MapPin,{className:\"w-5 h-5 text-green-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:userPreferences.primaryLocation.city}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[userPreferences.primaryLocation.province,\", \",userPreferences.primaryLocation.country]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLocationSelector(true),className:\"text-sm text-blue-600 hover:text-blue-700 font-medium\",children:\"Change\"})]})}),content&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-4 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:((_content$agent_respon=content.agent_response)===null||_content$agent_respon===void 0?void 0:(_content$agent_respon2=_content$agent_respon.sources_crawled)===null||_content$agent_respon2===void 0?void 0:_content$agent_respon2.length)||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Local Sources\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-4 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-5 h-5 text-green-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:(_content$agent_respon3=content.agent_response)!==null&&_content$agent_respon3!==void 0&&_content$agent_respon3.location_specific?'85%':'60%'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Match Score\"})]})]})})]}),/*#__PURE__*/_jsx(ContentFeed,{content:content,onRefresh:loadPersonalizedContent,location:userPreferences.primaryLocation}),showLocationSelector&&/*#__PURE__*/_jsx(LocationSelector,{onLocationSelect:handleLocationSelect,onClose:()=>setShowLocationSelector(false)})]});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","useUser","apiService","ContentFeed","LocationSelector","MapPin","Calendar","Users","TrendingUp","jsx","_jsx","jsxs","_jsxs","Home","_content$agent_respon","_content$agent_respon2","_content$agent_respon3","userPreferences","updateLocation","content","setContent","loading","setLoading","showLocationSelector","setShowLocationSelector","hasLocation","primaryLocation","loadPersonalizedContent","location","concat","city","province","response","getPersonalizedContent","interests","past_events","error","console","handleLocationSelect","className","children","onClick","onLocationSelect","onClose","country","agent_response","sources_crawled","length","location_specific","onRefresh"],"sources":["/Users/mohaimenkhan/repos/research-comm/ui/src/pages/Home.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useUser } from '../context/UserContext';\nimport { apiService } from '../services/apiService';\nimport ContentFeed from '../components/content/ContentFeed';\nimport LocationSelector from '../components/profile/LocationSelector';\nimport { MapPin, Calendar, Users, TrendingUp } from 'lucide-react';\n\nconst Home = () => {\n  const { userPreferences, updateLocation } = useUser();\n  const [content, setContent] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showLocationSelector, setShowLocationSelector] = useState(false);\n\n  const hasLocation = userPreferences?.primaryLocation;\n\n  useEffect(() => {\n    if (hasLocation) {\n      loadPersonalizedContent();\n    } else {\n      setLoading(false);\n    }\n  }, [hasLocation, userPreferences]);\n\n  const loadPersonalizedContent = async () => {\n    try {\n      setLoading(true);\n      const location = `${userPreferences.primaryLocation.city}, ${userPreferences.primaryLocation.province}`;\n\n      const response = await apiService.getPersonalizedContent(location, {\n        interests: userPreferences.interests,\n        past_events: [] // TODO: Track user's past events\n      });\n\n      setContent(response);\n    } catch (error) {\n      console.error('Failed to load content:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleLocationSelect = async (location) => {\n    try {\n      await updateLocation(location, true);\n      setShowLocationSelector(false);\n    } catch (error) {\n      console.error('Failed to update location:', error);\n    }\n  };\n\n  // Location setup screen\n  if (!hasLocation) {\n    return (\n      <div className=\"min-h-96 flex items-center justify-center\">\n        <div className=\"text-center space-y-6 max-w-md mx-auto px-6\">\n          <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto\">\n            <MapPin className=\"w-8 h-8 text-blue-600\" />\n          </div>\n\n          <div>\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\n              Welcome to Community Hub!\n            </h2>\n            <p className=\"text-gray-600\">\n              To get started, let us know where you're located so we can find relevant local events and news for you.\n            </p>\n          </div>\n\n          <button\n            onClick={() => setShowLocationSelector(true)}\n            className=\"btn-primary w-full\"\n          >\n            Set Your Location\n          </button>\n        </div>\n\n        {/* Location Selector Modal */}\n        {showLocationSelector && (\n          <LocationSelector\n            onLocationSelect={handleLocationSelect}\n            onClose={() => setShowLocationSelector(false)}\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Loading state\n  if (loading) {\n    return (\n      <div className=\"min-h-96 flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"spinner mx-auto\"></div>\n          <p className=\"text-gray-600\">Discovering community events...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Main content view\n  return (\n    <div className=\"space-y-6\">\n      {/* Location Header */}\n      <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\">\n              <MapPin className=\"w-5 h-5 text-green-600\" />\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-gray-900\">\n                {userPreferences.primaryLocation.city}\n              </h3>\n              <p className=\"text-sm text-gray-500\">\n                {userPreferences.primaryLocation.province}, {userPreferences.primaryLocation.country}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={() => setShowLocationSelector(true)}\n            className=\"text-sm text-blue-600 hover:text-blue-700 font-medium\"\n          >\n            Change\n          </button>\n        </div>\n      </div>\n\n      {/* Quick Stats */}\n      {content && (\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n            <div className=\"flex items-center space-x-3\">\n              <Calendar className=\"w-5 h-5 text-blue-600\" />\n              <div>\n                <p className=\"text-2xl font-bold text-gray-900\">\n                  {content.agent_response?.sources_crawled?.length || 0}\n                </p>\n                <p className=\"text-sm text-gray-500\">Local Sources</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n            <div className=\"flex items-center space-x-3\">\n              <TrendingUp className=\"w-5 h-5 text-green-600\" />\n              <div>\n                <p className=\"text-2xl font-bold text-gray-900\">\n                  {content.agent_response?.location_specific ? '85%' : '60%'}\n                </p>\n                <p className=\"text-sm text-gray-500\">Match Score</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Content Feed */}\n      <ContentFeed\n        content={content}\n        onRefresh={loadPersonalizedContent}\n        location={userPreferences.primaryLocation}\n      />\n\n      {/* Location Selector Modal */}\n      {showLocationSelector && (\n        <LocationSelector\n          onLocationSelect={handleLocationSelect}\n          onClose={() => setShowLocationSelector(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}